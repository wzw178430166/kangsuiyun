<!DOCTYPE html>
<html lang="cn">
<head>
<meta charset="UTF-8">
<meta name="viewport"
        content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<link rel="stylesheet" type="text/css" href="/statics/css/app/appstyle.css">
<link rel="stylesheet" type="text/css" href="/pharmacies/store/css/header_common.css?v=139">
<link rel="stylesheet" type="text/css" href="/pharmacies/store/css/left_.css?v=143">
<link rel="stylesheet" type="text/css" href="/pharmacies/store/css/index.css?v=135">
<link rel="stylesheet" href="/statics/admin/common/layui/css/layui.css" media="all">
<link rel="stylesheet" href="/statics/dataManage/css/bootstrap.css">
<script type="text/javascript" src="/statics/js/setFontSize.js"></script>
<script type="text/javascript" src="/statics/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/statics/admin/common/layui/layui.all.js"></script>
<script type="text/javascript" src="/statics/js/global.js"></script>
<title>签名管理</title>
<style>
.matst_back {
    width: 95%;
    display: flex;
    justify-content: space-between;
    margin: 0 auto;
    margin-top: .5rem;
}
.back_goo {
    width: 2rem;
    height: .9rem;
    line-height: .9rem;
    border: 1px solid #929292;
    color: #7d7272;
    text-align: center;
    border-radius: .1rem;
}
.back_goo svg {
    width: .6rem;
    height: .6rem;
    vertical-align: middle;
}
.backgoo-keep{float: right;
    color: #ffffff;
    height: 1rem;
    width: 2.8rem;
    line-height: 1rem;
    background: #1890FF;
    border: 1px solid #1890FF;}
 .backgoo-keep svg {
    width: .4rem;
    height: .4rem;margin-right: .1rem;
    vertical-align: middle;
}
.nav-content {
    width: 96%;
    display: flex;
    height: 2rem;
    line-height: 2rem;
    align-items: center;
    margin: 0 auto;
}
.nav-content .nav-icon {
    width: .1rem;
    height: .5rem;
    background: #EC6565;
}
.nav-content .nav-title {
    padding: 0 .2rem;
    color: #191616;
    font-size: .38rem;
    font-weight: 600;
}
.nav-content .nav-line {
    flex: 1;
    height: 1px;
    background: #e4e4e4;
}
.data-content {
    overflow: hidden;
    width: 97%;
    padding: .5rem .3rem 0rem .3rem;
    margin: .2rem auto;
    border-radius: .05rem;
    box-shadow: 0px 1px 3px 1px #eae8e8;
}
.commonlyused{color: red;}
.set-common{color: #000000;text-decoration: underline;}
.table tr th {
    font-weight: normal;
    background: #FAFAFA;
    height: .9rem;font-size: .3rem;
    line-height: .9rem;
}
.table th, .table td {
    padding: 5px 5px;
    height: .8rem;font-size: .32rem;
    line-height: .8rem;
    border-top: 1px solid #dddddd;
}
.table th, .table td a{font-size: .26rem;}
a {
    color: #426aff;
}
.cell-check input[type="checkbox"] {width: 15px;height: 15px;border:1px solid #666}
    .layui-laypage a, .layui-laypage span {
    height: 23px;
    line-height: 23px;
}
.layui-input {
    height: 24px!important;
}
.layui-laypage button, .layui-laypage input {
    height: 24px;
    line-height: 24px;
    vertical-align: middle;
}
.btn-batch {
    padding: 10px;
    background-color: #ffffff;
}
input {
    -webkit-appearance: listitem;
    -webkit-rtl-ordering: logical;
}
</style>
</head>
<body>
   <div class="outdiv">
      <div class="left" id="left">
          <!--#include file="left.html"-->
      </div>
       <div class="right_conter">
           <div style="width:auto;margin:auto;">
            <div class="conten_con">
                <div class="cotent_con_left">
                    <div class="header_box" id="header">
                        <!--#include file="header.html"-->   
                      </div>
                      <div class="h8vh"></div>
                      <div class="matst_back">
                        <div class="back_goo" onclick="goback()">
                            <svg t="1607408152481" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3504" width="48" height="48"><path d="M438.4 297.6c12.8 12.8 12.8 28.8 3.2 41.6l-3.2 3.2L300.8 480H800c19.2 0 32 12.8 32 32 0 16-12.8 28.8-28.8 32H300.8l137.6 137.6c12.8 12.8 12.8 28.8 3.2 41.6l-3.2 3.2c-12.8 12.8-28.8 12.8-41.6 3.2l-3.2-3.2-192-192-3.2-3.2-3.2-3.2-3.2-3.2V499.2l3.2-3.2 3.2-3.2 3.2-3.2 192-192c12.8-12.8 32-12.8 44.8 0z" fill="#bfbfbf" p-id="3505"></path></svg>
                            返回
                        </div>

                        <div class="back_goo backgoo-keep" onclick="goo('/pharmacies/store/add_autograph.html')">
                            <svg t="1607410816622" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5142" width="48" height="48"><path d="M793.6 42.656H42.656v938.656h938.656V230.368l-187.744-187.744z m-153.6 256v-128h42.656V384H341.312V170.656h213.344v128H640zM341.344 896v-213.344h341.344V896H341.344zM896 896h-128v-298.656H256V896H128V128h128v341.344h512v-332.8l128 128V896z" p-id="5143" fill="#ffffff"></path></svg>
                            新增签名
                        </div>
                    </div>
                 
                    <div class="nav-content">
                        <div class="nav-icon"></div>
                        <div class="nav-title">签名管理</div>
                        <div class="nav-line"></div>
                    </div>
   
                    <div class="data-content">
                        <div class="tb-container"  style="height: 60vh;overflow: auto;">
                            <table class="table" id="rstb">
                                <thead>
                                    <tr align="center">
                                       <th><strong class="tb-head cell-orderid" data-val="orderid">签名文件</strong></th>
                                       <th><strong class="tb-head cell-qmtype" data-val="qmtype">签名类型</strong></th>
                                       <th><strong class="tb-head cell-username" data-val="username">签名名称</strong></th>
                                       <th><strong class="tb-head cell-product" data-val="product">创建时间</strong></th>
                                       <th><strong class="tb-head cell-amount" data-val="amount">状态</strong></th>
                                       <th><strong class="tb-head cell-operate" data-val="operate">操作</strong></th>
                                       <th><strong class="tb-head cell-operate1" data-val="operate1"></strong></th>
                                   </tr>
                                 </thead>
                               <tbody id="data">
                                  <tr align="center">
                                      <td>1113454654654</td>
                                      <td>张三</td>
                                      <td>2020-02-03</td>
                                      <td>2</td>
                                      <td>
                                        <a href="#" class="commonlyused">常用签名</a>
                                     </td>
                                     <td>
                                        <a href="#">删除</a>
                                     </td>
                                  </tr>
                                  <tr align="center">
                                     <td>5113454654654</td>
                                     <td>张三</td>
                                     <td>2020-08-03</td>
                                     <td>2</td>
                                     <td>
                                        <a href="#" class="set-common">设置为常用签名</a>
                                     </td>
                                     <td>
                                        <a href="#">删除</a>
                                     </td>
                                  </tr>
                                  <tr align="center">
                                     <td>5113454654654</td>
                                     <td>张三</td>
                                     <td>2020-08-03</td>
                                     <td>2</td>
                                     <td>
                                        <a href="#" class="set-common">设置为常用签名</a>
                                     </td>
                                     <td>
                                        <a href="#">删除</a>
                                     </td>
                                  </tr>
                                  <tr align="center">
                                     <td>5113454654654</td>
                                     <td>张三</td>
                                     <td>2020-08-03</td>
                                     <td>2</td>
                                     <td>
                                        <a href="#" class="set-common">设置为常用签名</a>
                                     </td>
                                     <td>
                                        <a href="#">删除</a>
                                     </td>
                                  </tr>
                               </tbody>
                            </table>
                            <div class="inner-page" id="J_page"></div>
                        </div>
                      </div>

                </div>
             
            </div>
            
          </div>
       </div>
   </div>   
    <script>
        var page = 1;
        $(function (){
            getData();

           


        })
        function getData(){
        request('/?m=pharmacy&c=signature&a=lists&ajax=1','get',{
            dataType: 'jsonp',
            success: function(res){
                console.log(res); 
                var html = '';
                if (0<res.total) {
                  rows = res.rows;
                  for(var k in rows){
                      var info = rows[k];
                      html += '<tr align="center">\
                                      <td><img src="'+info.img+'" style="width:100px;height:30px;" onerror="Javascript:this.src=\'/pharmacies/store/images/babac.png\'"></td>\
                                      <td>药剂师签名</td>\
                                      <td>'+info.name+'</td>\
                                      <td>'+info.create_time+'</td>\
                                      <td>'+info.status_str+'</td>\
                                      <td>';
                      if(info.is_default==1){
                        html +='<a href="javascript:;" class="commonlyused">常用签名</a>';
                      }else{
                        html +='<a href="#" class="set-common" data-ids="'+info.id+'"  data-default="1">设置为常用签名</a>';  
                      }
                       html +='</td>\
                                     <td>\
                                        <a href="/pharmacies/store/add_autograph.html?&id='+info.id+'">编辑</a> <a href="javascript:;" class="del-common" data-ids="'+info.id+'">删除</a>\
                                     </td>\
                                  </tr>';
                  }
                } else {
                  html += '<tr align="center"><td colspan="'+($('.tb-head').length)+'">暂无数据</td></tr>';
                }
                $('#data').html(html);
                if(1==page) layuiPage({total:res.total});
                opstion();
            }
        });
    }
    function opstion() {
        $('.set-common').each(function (i){
            $(this).click(function (){
            var ids=$(this).data('ids');
            var defaults=$(this).data('default');
            layer.open({
                content: '确定设置常用签名吗？'
                ,btn: ['确定', '关闭']
                ,yes: function(index, layero){
                    var url = '/?m=pharmacy&c=signature&a=doDefault&ajax=1';
				    var formParam = {"dosubmit":1,"id":ids,"is_default":defaults};
                    $.post(url,formParam,function(data){
					layer.open({
                        title: '信息',
                        content: data.erro
                        });  
                        getData();   
					// if (data.status == 1) {
						
					// }
				     },'json');     
                }
                ,btn2: function(index, layero){
                    //return false 开启该代码可禁止点击该按钮关闭
                }
                });  
                    });
                })

                $('.del-common').each(function (i) {
                var ids=$(this).data('ids');
                $(this).click(function() {
                layer.open({
                content: '确定删除吗？'
                ,btn: ['确定', '关闭']
                ,yes: function(index, layero){
                    var url = '/?m=pharmacy&c=signature&a=delete&ajax=1';
				    var formParam = {"dosubmit":1,"id":ids};
                    $.post(url,formParam,function(data){
					if (data.status == 1) {
                        layer.open({
                        title: '信息',
                        content: data.erro
                        }); 
						getData();
					}
				     },'json');     
                }
                ,btn2: function(index, layero){
                    //return false 开启该代码可禁止点击该按钮关闭
                }
                });    
            })
				});   
                    
                
         }
    </script>
</body>
</html>