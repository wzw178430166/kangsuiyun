<!DOCTYPE html>
<html lang="cn">
<head>
<meta charset="UTF-8">
<meta name="viewport"
        content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<link rel="stylesheet" type="text/css" href="/statics/css/app/appstyle.css">
<link rel="stylesheet" type="text/css" href="/pharmacies/doctor/css/header_common.css?v=174">
<link rel="stylesheet" type="text/css" href="/pharmacies/doctor/css/left_.css?v=195">
<link rel="stylesheet" type="text/css" href="/pharmacies/doctor/css/index.css?v=126">
<link rel="stylesheet" href="/statics/admin/common/layui/css/layui.css" media="all">
<link rel="stylesheet" href="/statics/dataManage/css/bootstrap.css">
<script type="text/javascript" src="/statics/js/setFontSize.js"></script>
<script type="text/javascript" src="/statics/js/global.js"></script>
<script  src="/statics/public/plug/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="/statics/admin/common/layui/layui.all.js"></script>
<script  src="/statics/public/plug/jSignature/src/jSignature.js"></script>
<title>新增签名</title>
<style>
 .query-btn .btn-item {
    margin-left: 0px;
}
.query-btn .btn-item {
    height: auto;
    min-height: 26px;
}
.query-btn .btn-item {
    height: auto;
    min-height: 26px;
    text-align: center;
}
.matst_back {
    width: 95%;
    display: flex;
    justify-content: space-between;
    margin: 0 auto;
    margin-top: .5rem;
}
.back_goo {
    width: 2rem;
    height: .9rem;
    line-height: .9rem;
    border: 1px solid #929292;
    color: #7d7272;
    text-align: center;
    border-radius: .1rem;
}
.back_goo svg {
    width: .6rem;
    height: .6rem;
    vertical-align: middle;
}
.backgoo-keep{float: right;
    color: #ffffff;
    height: 1rem;
    width: 2.8rem;
    line-height: 1rem;
    background: #1890FF;
    border: 1px solid #1890FF;}
 .backgoo-keep svg {
    width: .4rem;
    height: .4rem;margin-right: .1rem;
    vertical-align: middle;
}
  
.conten_con{width: 100%;display: flex;height: 100vh;}
.conten_con .cotent_con_left{width: 100%;border-right: 1px solid #e4e4e4;}

.lines{width: 96%;;margin: .8rem auto .3rem auto;}

.ctab_bottom{    
    width: 96%;
    margin: 0 auto;
    display: flex;
    justify-content: center;}
.ctab_bottom span{float: right;
    width: 3rem;
    height: 1rem;
    font-size: .38rem;
    line-height: 1rem;
    border: 1px solid #339EFC;
    text-align: center;
    border-radius: .07rem;}
.ctab_bottom span{background: #339EFC;color: #ffffff;}
.ctab_bottom span.mspans svg{width: .5rem;
    height: .5rem;
    vertical-align: middle;
    margin-right: .1rem;}

.clear {
    clear: both;
}
#tab-con .tab_itemst {
    width: 100%;
    /* height: 10rem; */
    position: relative;
    display: none;
}
#tab-con .on {
    display: block;
    background-color: #fff;
}
#tab-con .ae {
    width: 3rem;
    height: 3rem;
    background: red;
}
.henline {
    height: .3rem;
    background: #ffffff;
}
.tab_itemst .tcontbox {
    width: 100%;margin-top: .9rem;
}
.tab_itemst .tcontbox .tconp {
    display: flex;
    justify-content: space-between;
    height: 3.2rem;
    line-height: 3.2rem;
    border-bottom: 1px solid #dcdcdc;
    width: 93%;
    margin: 0 auto;
    padding: 0 .5rem;
    font-size: 1.1rem;
    color: #2b2b2b;
}
.mtable{border: 1px solid #BBBBBB;width: 90%;margin: 0 auto;}
.mtable tr th{width: 20%;
    background: #F5F5F5;
    color: #1d1c1c;
    padding: .3rem .2rem .3rem 0;
    text-align: right;}

.conb_br{    
    width: 100%;
    height: 100vh;
    align-items: center;
    display: flex;}
.conb_br .conb_left{
    /* background: url(../images/iphonebor11.png) no-repeat center 1rem;background-size: 80%; */
    width: 70%;
    margin: 0 auto;
    background-size: 80%;
    overflow: hidden;
}
    .conb_br .conb_lefts{
        width: 100%;overflow: hidden;
    }
    .conts_imgs{width: 18vh;
        height: 33vh;
        position: absolute;
        top: 65vh;
        transform: translate(-50%,-50%);
        left: 14.5vh;}
    .conts_imgs img{width: 100%;height: 100%;object-fit: cover;} 
.conb_br .conb_right{    width: 60%;
    background: url(../images/con_right_bg.png) no-repeat bottom right;
    background-size: 25%;
    padding-top: 2rem;}


.mtable tr td.thumbnail{padding: .2rem;border: 0;}
.mtable tr td.thumbnail img{width: 100%;height: 4.9rem;}
.mtable tr td{padding: 0 .2rem;}
.reseted{padding: .1rem .3rem;
    border: 1px solid #b9acac;
    color: #504b4b;
    font-size: .35rem;position: absolute;right: 15%;top: 5%;
    border-radius: .05rem;}
</style>
</head>
<body>
   <div class="outdiv">
      <div class="left" id="left">
          <!--#include file="left.html"-->
      </div>
       <div class="right_conter">
           <div style="width:auto;margin:auto;">
            <div class="conten_con">
                <div class="cotent_con_left">
                    <div class="header_box" id="header">
                        <!--#include file="header.html"-->   
                      </div>
                      <div class="h8vh"></div>
                      <div class="matst_back">
                        <div class="back_goo" onclick="goback()">
                            <svg t="1607408152481" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3504" width="48" height="48"><path d="M438.4 297.6c12.8 12.8 12.8 28.8 3.2 41.6l-3.2 3.2L300.8 480H800c19.2 0 32 12.8 32 32 0 16-12.8 28.8-28.8 32H300.8l137.6 137.6c12.8 12.8 12.8 28.8 3.2 41.6l-3.2 3.2c-12.8 12.8-28.8 12.8-41.6 3.2l-3.2-3.2-192-192-3.2-3.2-3.2-3.2-3.2-3.2V499.2l3.2-3.2 3.2-3.2 3.2-3.2 192-192c12.8-12.8 32-12.8 44.8 0z" fill="#bfbfbf" p-id="3505"></path></svg>
                            返回
                        </div>
                    </div>
                    
                      <div id="tab-con">
                        <div class="tab_itemst on"> 
                     
                          <div class="tcontbox">
                              <table class="mtable" border="1" cellspacing="0">
                                <tr>
                                    <th>姓名：</th>
                                    <td colspan="3"> 
                                    <input type="text" name="name" id="name" style="width: 90%;height: 100%;border: 0;box-shadow: 0 0px 0px rgba(0, 0, 0, 0.075);">    
                                    </td>
                                </tr>
                                <tr>
                                    <th>签名类型：</th>
                                    <td colspan="3"> 医生签名  </td>
                                </tr>
                                <tr style="height: 6rem;">
                                    <th>签名区域：</th>
                                    <td colspan="2" style="border: 0;width: 70%;height: 100%;position: relative;" id="signature">
                                      <div style="display:none;position:absolute;top: 0;left: 0;width: 100%;height: 100%;" id="stypimg">
                                      <img src="#" id="uimg" style="width: 100%;height: 100%;">
                                    </div>
                                    </td>
                                    <td style="width: 2rem;position: relative;border: 0;"><span class="reseted" id="reseted">重签</span></td>
                                </tr>
                                <tr>
                                    <th>设置为默认常用签名：</th>
                                    <td colspan="3">  
                                      <label style="float: left;">是 <input type="radio" name="is_default" value="1" checked></label> 
                                      <label>否 <input type="radio" name="is_default" value="0"></label>
                                    </td>
                                </tr>
                              </table>

                              <p class="lines"></p>
                              <div class="ctab_bottom">
                                
                                  <span class="mspans" id="mspans">
                                    <svg t="1607410816622" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5142" width="48" height="48"><path d="M793.6 42.656H42.656v938.656h938.656V230.368l-187.744-187.744z m-153.6 256v-128h42.656V384H341.312V170.656h213.344v128H640zM341.344 896v-213.344h341.344V896H341.344zM896 896h-128v-298.656H256V896H128V128h128v341.344h512v-332.8l128 128V896z" p-id="5143" fill="#ffffff"></path></svg>  
                                    提交签名</span>
                              </div>
                              <div style="height: .3rem;"></div>
                          </div>
                    
                        </div>
                       
                      </div>
                </div>
             
            </div>
            
          </div>
       </div>
   </div>   
 <script>
     var id = getQueryString('id')?getQueryString('id'):0;
    var $sigdiv;
	$(function(){
        console.log(id);
        if (0<id) getData();
        var signature = [];
        var $sigdiv = $("#signature").jSignature({'UndoButton':true});
        var name=Cookies.get('verify_user_name');
        $('#name').val(name);



        $('#mspans').click(function () {
            var uname= $('#name').val();
            var res = $sigdiv.jSignature('getData','default');//导出结果 参数二为导出格式 默认为默认格式base64
            var len=res.length;
         
            //console.log(res);return;
            //$('#signature_value').val(res);
            var ifdeford=$('[name="is_default"]:checked').val();
            var parm={user_id: Cookies.get('verify_user_id'),base64:res,name:uname,is_default:ifdeford,dosubmit:1};
            if(id){parm.id=id};
            if(len>=2314&&len<=5000){
            alert('请重新签名');
            console.log(len);
            return;
            }else{
                request('/?m=pharmacy&c=signature&a=doSignature&ajax=1','post',{
            dataType: 'json',
            data: parm,
            success: function(res){
                alert(res.erro);
                window.location.href="/pharmacies/doctor/autographk_list.html";
            }
        });
             }
             console.log(len);
        });




        $('#reseted').click(function() {
        $('#stypimg').hide();
        $sigdiv.jSignature('reset');
        $('#signature_id').val(0);
        $('#signature_value').val('');
        });
    });
    function getData(){
        request('/?m=pharmacy&c=signature&a=doSignature&ajax=1','get',{
            dataType: 'jsonp',
            data: {id: id},
            success: function(res){
              if(1==res.status){
                var data=res.data;
                $('#name').val(data.name);
                $('#stypimg').show();
                $('#uimg').attr('src',data.img);
                $("[name='is_default'][value='" + data.is_default + "']").prop("checked", true);
                //   layer.open({
                //      title: '信息'
                //     ,content: res
                //     });  
            }
            }
        });
     
    }
    
 </script>
</body>
</html>